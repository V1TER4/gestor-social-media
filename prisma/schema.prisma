generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
}

model users {
    id          String @id @default (uuid())
    name        String
    birthdate   DateTime ?
    document    String @unique
    email       String @unique
    password    String
    workspaces  workspace_users[]
    posts       posts[]
    createdAt   DateTime @default (now())
    updatedAt   DateTime @default (now())
}

model workspaces {
    id              String @id @default (uuid())
    name            String
    users           workspace_users[]
    socialAccounts  social_accounts[]
    posts           posts[]
    createdAt       DateTime @default (now())
    updatedAt       DateTime @updatedAt
}

model workspace_users {
    id          String @id @default (uuid())
    user        users @relation(fields: [userId], references: [id])
    userId      String
    workspace   workspaces @relation(fields: [workspaceId], references: [id])
    workspaceId String
    role        String     // ADMIN | MEMBER

    @@unique([userId, workspaceId])
}

model social_accounts {
    id              String @id @default (uuid())
    provider        String     // INSTAGRAM | FACEBOOK | TIKTOK
    accessToken     String
    refreshToken    String ?
    workspace       workspaces @relation(fields: [workspaceId], references: [id])
    workspaceId     String
    posts           posts[]
    createdAt       DateTime @default (now())
}

model posts {
    id              String @id @default (uuid())
    content         String
    scheduledAt     DateTime ?
    publishedAt     DateTime ?
    status          PostStatus @default (DRAFT)

    user            users @relation(fields: [userId], references: [id])
    userId          String

    workspace       workspaces @relation(fields: [workspaceId], references: [id])
    workspaceId     String

    socialAccount       social_accounts @relation(fields: [socialAccountId], references: [id])
    socialAccountId     String

    createdAt       DateTime @default (now())
    updatedAt       DateTime @updatedAt
}

model parameters {
    id          String @id @default (uuid())
    code        String ?
    description String ?
    value       String

    createdAt       DateTime @default (now())
    updatedAt       DateTime @updatedAt
}

enum PostStatus {
    DRAFT
    SCHEDULED
    PUBLISHED
    FAILED
}
